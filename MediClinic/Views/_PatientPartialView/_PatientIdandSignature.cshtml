@model MediClinic.Models.PatientViewModel
@{

    var Action = ViewBag.Action;
    var WriteSignatureImage = ViewBag.WriteSignature;
    var HiddenimageForPatient = ViewBag.PatientImage;
    var image = ViewBag.PatientImage;
    var SignImage = ViewBag.SignImage;
    var HiddenSignForPatient = ViewBag.SignImage;
    var patientId = ViewBag.PatientId;



    //if (!(image is null))
    //{
    //    image = "/images/" + ViewBag.PatientImage;
    //}
    //else
    //{
    //    image = string.Empty;
    //}
    if (SignImage == "")
    {
        SignImage = string.Empty;
    }
    else if (!(SignImage is null))
    {
        SignImage = "/images/" + ViewBag.SignImage;
    }
    else
    {
        SignImage = string.Empty;
    }
}
<div class="content-area content-right">
    <div class="app-wrapper">

        <div class="card card card-default scrollspy border-radius-6 fixed-width">
            <div class="card-content padding-3">
                <div class="row mb-1">


                    <div class="col s12">
                        <div class="container">
                            <div class="row">
                                <div class="col s6 m5">
                                    <h5 class="breadcrumbs-title color-blue">Patient ID & Signature</h5>
                                </div>


                                <div class="col s6 m7 mt-3">


                                    <a class=" float-right ml-3">

                                        <i class="color-blue material-icons float-left">
                                            local_printshop
                                        </i>
                                    </a>
                                    <a class=" float-right ml-3">

                                        <i class=" material-icons" style="color:#306ab5">attach_file</i>
                                    </a>
                                    <a class=" float-right ml-3">

                                        <i class="color-blue material-icons">assignment</i>
                                    </a>
                                    <a class=" float-right ml-3 imageSection" id="cameraIcon" onclick="OpenImageSection();">

                                        <i class="fas fa-camera"></i>
                                    </a>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col s12">
                                    <form enctype="multipart/form-data" asp-action="PatientIdandSignature" asp-controller="PatientSide" id="signatureform" method="post">
                                        <input class="text-input input-styling" asp-for="patientIdandSignature.UserId" id="PatientIDSign_UserId" type="text" hidden="hidden">
                                        <input hidden="hidden" asp-for="patientIdandSignature.PatientSignatureId" />
                                        <input hidden="hidden" id="hiddenSignatureUserId" asp-for="patientInfoBasicDto.UserId" />
                                        <div class="row">
                                            <div class="col s12 m6 ">
                                                <p>Passport Number?</p>
                                                <div class="col s4 m4 input-field pl-0 mt-3">
                                                    <p class="check-btn">
                                                        <label>
                                                            <input type="radio" id="PassportNumberYes" class="with-gap patientSignatureTxtField" name="passportYes" value="1" />
                                                            <span>Yes</span>
                                                        </label>
                                                    </p>

                                                </div>
                                                <div class="col s4 m4 input-field pl-0 mt-3">
                                                    <p class="check-btn">
                                                        <label>
                                                            <input type="radio" id="PassportNumberno" class="with-gap patientSignatureTxtField" name="passportYes" value="0" />
                                                            <span>No</span>
                                                        </label>
                                                    </p>

                                                </div>
                                                <div class="input-field pl-0" id="Passport_HideShow" style="display:none">
                                                    <p>Passport Number</p>

                                                    <input class="text-input mt-2 signaturePassportNumber signatureandId_tab patientSignatureTxtField" asp-for="patientIdandSignature.PassportNumber" type="text" placeholder="Enter Passport Number">
                                                    @*<span class="required" asp-validation-for="patientIdandSignature.PassportNumber"></span>*@
                                                </div>
                                                <div class="input-field pl-0">
                                                    <p>ID Type</p>
                                                    <div class="ui-widget signatueSelect_tab  col s9 m10 pl-0">
                                                        <select id="SignatureIdType" class="SignatureTypeId genericClassForDD signatureDropDListBeforeEditDisabled" asp-for="patientIdandSignature.TypeId"
                                                                asp-items="@(new SelectList(Model.PatientSignatureIdTypeList,"TypeId","TypeName"))">
                                                            <option></option>
                                                        </select>
                                                    </div>

                                                    <div class="input-field col s3 m2 pr-0">
                                                        <a class="btn form-add-btn sidenav-trigger sideout" href="javascript:void(0);" data-target="slide-out-right14"><i class="material-icons">add</i></a>
                                                    </div>
                                                </div>
                                                <div class="input-field pl-0">
                                                    <p>ID Number</p>
                                                    <input class="text-input mt-2 SignatureIdNumber signatureandId_tab patientSignatureTxtField" asp-for="patientIdandSignature.IdNumber" type="text" placeholder="Enter ID Number">
                                                </div>
                                            </div>
                                            <div class="col s12 m6 pr-0">
                                                <p class="mb-2">Patient Photo</p>
                                                <div class="input-field col s6 pl-0">
                                                    <div class="center">

                                                        <div class="docs-preview clearfix">
                                                            <div class="img-preview preview-lg">
                                                                <div id="result-wrapper">
                                                                    @if (Action == "Update")
                                                                    {
                                                                        @if (image == null)
                                                                        {
                                                                            <a class="remove-image removebtn-show" href="javascript:void(0)" style="display: inline;display:none;">&#215;</a>
                                                                            <div class="middle">
                                                                                <div class="text">
                                                                                    <a class=" modal-trigger" href="#modal1"><i class="material-icons">add_a_photo</i></a>
                                                                                    <p>Upload</p>
                                                                                </div>
                                                                            </div>

                                                                            <img src="~/app-assets/images/user/male-user.png" class="empty_img" id="result" style=" width: 250px; height: 250px; border-radius:50%;border:2px solid #f5f5f5">

                                                                        }
                                                                        else if (image == "")
                                                                        {
                                                                            <a class="remove-image removebtn-show" href="javascript:void(0)" style="display: inline;display:none;">&#215;</a>
                                                                            <div class="middle">
                                                                                <div class="text">
                                                                                    <a class=" modal-trigger" href="#modal1"><i class="material-icons">add_a_photo</i></a>
                                                                                    <p>Upload</p>
                                                                                </div>
                                                                            </div>

                                                                            <img src="~/app-assets/images/user/male-user.png" class="empty_img" id="result" style=" width: 250px; height: 250px; border-radius:50%;border:2px solid #f5f5f5">

                                                                        }
                                                                        else
                                                                        {
                                                                            <a class="remove-image" href="javascript:void(0)" style="display: inline;">&#215;</a>
                                                                            <div class="middle">
                                                                                <div class="text">
                                                                                    <a class=" modal-trigger" href="#modal1"><i class="material-icons">add_a_photo</i></a>

                                                                                    <p>Upload</p>
                                                                                </div>
                                                                            </div>
                                                                            @*<img src="~/app-assets/images/user/male-user.png" class="empty_img" id="result" style=" width: 250px; height: 250px; border-radius:50%;border:2px solid #f5f5f5;display:none">*@
                                                                            <img src="/images/@image" id="result" class="list_image" style=" width: 250px; height: 250px; border-radius:50%;border:2px solid #f5f5f5">
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        <a class="remove-image removebtn-show" href="javascript:void(0)" style="display: inline;display:none;">&#215;</a>
                                                                        <div class="middle">
                                                                            <div class="text">
                                                                                <a class=" modal-trigger" href="#modal1"><i class="material-icons">add_a_photo</i></a>
                                                                                <p>Upload</p>
                                                                            </div>
                                                                        </div>

                                                                        <img src="~/app-assets/images/user/male-user.png" class="empty_img" id="result" style=" width: 250px; height: 250px; border-radius:50%;border:2px solid #f5f5f5">
                                                                    }
                                                                </div>
                                                                <div class="panel panel-default" id="captureImageFromCam">
                                                                    <div class="panel-heading">Camera</div>
                                                                    <div class="panel-body">
                                                                        <div id="my_camera"></div>
                                                                        <!-- A button for taking snaps -->
                                                                        <a class="btn btn-info" onClick="take_snapshot()"> Take Snapshot</a>

                                                                    </div>
                                                                </div>
                                                            </div>
                                                            @*@if (image != "")
                                                                {

                                                                }
                                                                <div class="middle">
                                                                    <div class="text">
                                                                        <a class=" modal-trigger" href="#modal1"><i class="material-icons">add_a_photo</i></a>
                                                                        <p>Upload</p>
                                                                    </div>
                                                                </div>*@

                                                        </div>
                                                        <div id="modal1" class="modal imageModel">
                                                            <div class="modal-content">

                                                                <div class="row">
                                                                    <div id="main-cropper"></div>
                                                                    @*<a class="btn actionDone">Done</a>
                                                                        <a class="btn actionCancel">Cancel</a>*@
                                                                </div>
                                                                <div class="row">
                                                                    <a class="btn add-btn button actionUpload">
                                                                        <i class="material-icons">cloud_upload</i>
                                                                        <input type="file" class="custom-file-input" id="upload">
                                                                    </a>
                                                                    <a id="rotateLeft" class="btn add-btn" data-deg="-90"><i class="material-icons">rotate_left</i></a>
                                                                    <a id="rotateRight" class="btn add-btn" data-deg="90"><i class="material-icons">rotate_right</i></a>
                                                                    <a class="btn modal-close add-btn" disabled id="showResult">Save</a>
                                                                    @*<a class="btn add-btn" disabled id="RemoveResult">Remove</a>*@
                                                                    <a class="btn modal-close add-btn">Cancel</a>
                                                                </div>
                                                            </div>



                                                            @*<div class="modal-footer">

                                                                    <a href="javascript:void(0);" class="modal-action modal-close btn ">Save</a>
                                                                    <a href="javascript:void(0);" class="modal-action modal-close btn btn-secondary">Cancel</a>
                                                                </div>*@
                                                        </div>
                                                    </div>
                                                    @*<input type="file" id="filess" asp-for="patientIdandSignature.PaitentImage" class="dropify forPatient mt-2" data-default-file="@image" />*@
                                                    <input id="HidenProfilePic" hidden="hidden" value="@HiddenimageForPatient" asp-for="patientIdandSignature.HiddenimagePath" />
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col s12 m6 ">
                                                <div class="input-field  pl-0">
                                                    <p>Electronic Signature Password <span class="required"> * </span></p>

                                                    <input autocomplete="off" class="text-input mt-2 signatureandId_tab patientSignatureTxtField SignaturePasswordFeild" asp-for="patientIdandSignature.ElectronicSignature" value="@ViewBag.SignaturePassword" type="password" placeholder="Enter Electronic Signature">
                                                    <span class="required" asp-validation-for="patientIdandSignature.ElectronicSignature"></span>
                                                    <br />
                                                    <a href="javascript:void(0);">Forgot Signature Password?</a>
                                                </div>
                                            </div>
                                            <div class="col s12 m6 ">
                                                <div class="input-field  pl-0">
                                                    <p>Confirm Electronic Signature Password <span class="required"> * </span></p>
                                                    <input autocomplete="off" class="text-input mt-2 signatureandId_tab patientSignatureTxtField SignatureConfirmPasswordFeild" type="password" asp-for="patientIdandSignature.ConfirmElectronicSignature" value="@ViewBag.SignaturePassword" placeholder="Password">
                                                    <span class="required" asp-validation-for="patientIdandSignature.ConfirmElectronicSignature"></span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col s12 12">
                                                @if (Action == "Update")
                                                {
                                                    if (WriteSignatureImage == "Empty.png")
                                                    {
                                                        <p>Write Signature</p>
                                                        <div id="signature-pad1" class="m-signature-pad mt-2 mb-2">
                                                            <div class="m-signature-pad--body">
                                                                <canvas id="sigCanvas" width="500" height="200"></canvas>
                                                            </div>
                                                            <div class="m-signature-pad--footer pull-right" style="text-align: right;">
                                                                <div class="description">Save Your signature before submit the form</div>
                                                                <button type="button" class="btn btn-sm uploadImageFromSignatureBox" id="pad_clear">
                                                                    Upload Image
                                                                </button>
                                                                <button type="button" class="btn btn-sm clear signature_pad_clear" id="pad_clear" data-action="clear">
                                                                    Clear
                                                                </button>
                                                                <button type="button" id="accept" class="btn btn-sm btn-info save1" data-action="save">
                                                                    Save Signature
                                                                </button>


                                                            </div>
                                                        </div>
                                                        <img id="savetarget" height="250" width="600"/>
                                                        <input type="file" id="SignatureImageUpload" asp-for="patientIdandSignature.WriteSignature" style="display:none" />

                                                        <span class="WriteSignatureError required"></span>
                                                    }
                                                    else if (WriteSignatureImage == null)
                                                    {
                                                        <p>Write Signature</p>
                                                        <div id="signature-pad1" class="m-signature-pad mt-2 mb-2">
                                                            <div class="m-signature-pad--body">
                                                                <canvas id="sigCanvas" width="500" height="200"></canvas>
                                                            </div>
                                                            <div class="m-signature-pad--footer pull-right" style="text-align: right;">
                                                                <div class="description">Save Your signature before submit the form</div>
                                                                <button type="button" class="btn btn-sm uploadImageFromSignatureBox" id="pad_clear">
                                                                    Upload Image
                                                                </button>
                                                                <button type="button" class="btn btn-sm clear signature_pad_clear" id="pad_clear" data-action="clear">
                                                                    Clear
                                                                </button>
                                                                <button type="button" id="accept" class="btn btn-sm btn-info save1" data-action="save">
                                                                    Save Signature
                                                                </button>


                                                            </div>
                                                        </div>
                                                        <img id="savetarget" height="250" width="600"/>
                                                        <input type="file" id="SignatureImageUpload" asp-for="patientIdandSignature.WriteSignature" style="display:none" />

                                                        <span class="WriteSignatureError required"></span>
                                                    }
                                                    else if (WriteSignatureImage == "")
                                                    {
                                                        <p>Write Signature</p>
                                                        <div id="signature-pad1" class="m-signature-pad mt-2 mb-2">
                                                            <div class="m-signature-pad--body">
                                                                <canvas id="sigCanvas" width="500" height="200"></canvas>
                                                            </div>
                                                            <div class="m-signature-pad--footer pull-right" style="text-align: right;">
                                                                <div class="description">Save Your signature before submit the form</div>
                                                                <button type="button" class="btn btn-sm uploadImageFromSignatureBox" id="pad_clear">
                                                                    Upload Image
                                                                </button>
                                                                <button type="button" class="btn btn-sm clear signature_pad_clear" id="pad_clear" data-action="clear">
                                                                    Clear
                                                                </button>
                                                                <button type="button" id="accept" class="btn btn-sm btn-info save1" data-action="save">
                                                                    Save Signature
                                                                </button>


                                                            </div>
                                                        </div>

                                                        <img id="savetarget" height="250" style="width:600px" />
                                                        <input type="file" id="SignatureImageUpload" asp-for="patientIdandSignature.WriteSignature" style="display:none" />

                                                    }
                                                    else
                                                    {
                                                        <p>Your Signature is :</p>
                                                        <img id="savetarget" height="250" width="450" />

                                                        <img src="/SignatureImages/@WriteSignatureImage" class="SignatureImageUpdate" id="UpdateCaseSignature" height="250" />
                                                        <div class="row">
                                                            <div class="col s12 ">
                                                                <a class="Signaturepad_show btn patientSignatureTxtField">Update Signature</a>
                                                                @*@if (SignImage == "")
                                                                    {

                                                                    }
                                                                    else
                                                                    {
                                                                        <a class="UploadSignature_show btn ml-2 patientSignatureTxtField">Upload Signature Image</a>

                                                                    }*@
                                                            </div>

                                                        </div>

                                                        <div id="signature-pad1" class="m-signature-pad mt-2 mb-2">
                                                            <div class="m-signature-pad--body">
                                                                <canvas id="sigCanvas" width="500" height="200"></canvas>
                                                            </div>
                                                            <div class="m-signature-pad--footer pull-right" style="text-align: right;">
                                                                <div class="description">Save Your signature before submit the form</div>
                                                                <button type="button" class="btn btn-sm uploadImageFromSignatureBox">
                                                                    Upload Image
                                                                </button>
                                                                <button type="button" class="btn btn-sm clear signature_pad_cancel">
                                                                    Cancel
                                                                </button>
                                                                <button type="button" class="btn btn-sm clear signature_pad_clear" data-action="clear">
                                                                    Clear
                                                                </button>
                                                                <button type="button" id="accept" class="btn btn-sm btn-info save1" data-action="save">
                                                                    Save Signature
                                                                </button>


                                                            </div>
                                                        </div>
                                                        <span class="WriteSignatureError required"></span>
                                                        <input type="file" id="SignatureImageUpload" asp-for="patientIdandSignature.WriteSignature" style="display:none" />

                                                    }

                                                }
                                                else
                                                {
                                                    <p>Write Signature Or Upload Signature Image</p>
                                                    <div id="signature-pad1" class="m-signature-pad mt-2 mb-2">
                                                        <div class="m-signature-pad--body">
                                                            <canvas id="sigCanvas" width="500" height="200"></canvas>
                                                        </div>
                                                        <div class="m-signature-pad--footer pull-right" style="text-align: right;">
                                                            <div class="description">Save Your signature before submit the form</div>
                                                            <button type="button" class="btn btn-sm uploadImageFromSignatureBox">
                                                                Upload Image
                                                            </button>
                                                            <button type="button" class="btn btn-sm clear signature_pad_clear" id="pad_clear" data-action="clear">
                                                                Clear
                                                            </button>
                                                            <button type="button" id="accept" class="btn btn-sm btn-info save1" data-action="save">
                                                                Save Signature
                                                            </button>


                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col m6">
                                                            <img id="savetarget" height="250" width="600" />

                                                        </div>
                                                    </div>
                                                    <span class="WriteSignatureError required"></span>
                                                    <input type="file" id="SignatureImageUpload" style="display:none" />
                                                }
                                                <input id="hiddneWriteSign" hidden="hidden" value="@WriteSignatureImage" asp-for="patientIdandSignature.HidddentWriteSigniamge">
                                                <input id="HidenSignaturePic" hidden="hidden" value="@HiddenSignForPatient" asp-for="patientIdandSignature.HiddenSignImg" />

                                            </div>

                                        </div>
                                        @*<div class="row">
                                                <div class="col s12 m4 signImage">
                                                    @if (Action == "Update")
                                                    {
                                                        if (SignImage == "")
                                                        {
                                                            <p class="signatureimage_text">Upload Signature Image</p>
                                                            <input type="file" id="files" asp-for="patientIdandSignature.SignatureImage" class="dropify" />
                                                        }
                                                        else
                                                        {
                                                            <p>Your Signature Image is:</p>
                                                            <img src="@SignImage" class="SignatureImageUpdate" height="250" />
                                                            <a class="remove-Sigatureimage right" href="javascript:void(0)">&#215;</a>
                                                            <div id="dropifyimage">
                                                                <input type="file" id="files" asp-for="patientIdandSignature.SignatureImage" class="dropify forPatientSignatures" />

                                                            </div>
                                                        }
                                                    }


                                                </div>
                                            </div>*@


                                        <div class="row">
                                            <div class="col s6 m6 pr-0">
                                                <p class="check-btn">
                                                    <label>
                                                        <input type="checkbox" class="filled-in checkFirst patientSignatureTxtField" asp-for="patientIdandSignature.IsSMSNotified" />
                                                        <span>Accept SMS Notification & Reminders</span>
                                                    </label>
                                                </p>
                                            </div>
                                            <div class="col s6 m6 pr-0">
                                                <p class="check-btn">
                                                    <label>
                                                        <input type="checkbox" class="filled-in checkFirst patientSignatureTxtField" asp-for="patientIdandSignature.IsEmailNotified" />
                                                        <span>Accept Email Notification & Reminders</span>
                                                    </label>
                                                </p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col s6 m6 pr-0">
                                                <p class="check-btn">
                                                    <label>
                                                        <input type="checkbox" class="filled-in checkFirst patientSignatureTxtField" asp-for="patientIdandSignature.IsFaceRecognition" />
                                                        <span>Accept Face recognition</span>
                                                    </label>
                                                </p>
                                            </div>
                                            <div class="col s6 m6 pr-0">
                                                <p class="check-btn">
                                                    <label>
                                                        <input type="checkbox" class="filled-in checkFirst patientSignatureTxtField" asp-for="patientIdandSignature.IsBiometricRecognition" />
                                                        <span>Accept Biometric recognition</span>
                                                    </label>
                                                </p>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col s12 m6 pr-0">
                                                <p class="check-btn">
                                                    <label>
                                                        <span style="font-size:16px;"> Communication Preference :</span>
                                                    </label>
                                                </p>
                                            </div>
                                        </div>
                                        <div class="row">

                                            <div class="col s4 m2">
                                                <p class="check-btn">
                                                    <label>
                                                        <input type="checkbox" class="filled-in checkFirst patientSignatureTxtField" asp-for="patientIdandSignature.IsComunicationSMS" />
                                                        <span> SMS</span>
                                                    </label>
                                                </p>

                                            </div>
                                            <div class="col s4 m2">
                                                <p class="check-btn">
                                                    <label>
                                                        <input type="checkbox" class="filled-in checkFirst patientSignatureTxtField" asp-for="patientIdandSignature.IsComunicationPhone" />
                                                        <span> Phone</span>
                                                    </label>
                                                </p>
                                            </div>
                                            <div class="col s4 m2">
                                                <p class="check-btn">
                                                    <label>
                                                        <input type="checkbox" class="filled-in checkFirst patientSignatureTxtField" asp-for="patientIdandSignature.IsComunicationEmail" />
                                                        <span>Email</span>
                                                    </label>
                                                </p>
                                            </div>

                                        </div>
                                        <div class="row set_rowbtn">
                                            <div class="col s12 m12" style="text-align:center">
                                                <button type="submit" id="upload" class="btn add-btn patientSigFormSub">Save</button>
                                                @*<button type="submit" id="SignEdit_Btn" class="btn Recreate">Edit</button>

                                                    <a href="javascript:void(0);" class="waves-effect waves-light Recreate btn">Cancel</a>*@
                                                @if (ViewBag.Action == "Update")
                                                {
                                                    <button type="button" data-val="signatureForm" id="signatureEdit_btn" class="btn Recreate patientEditBtn">Edit</button>
                                                    <button type="button" data-val="signatureForm" id="signatureCancel_btn" class="Recreate btn patientCancelBtn">Cancel</button>
                                                }
                                                else
                                                {
                                                    @*<a href="javascript:void(0);" data-val="NewForm" id="emergenyEdit_btn"  class="btn Recreate">Edit</a>*@
                                                    <a href="javascript:void(0);" data-val="NewForm" id="emergenyCancel_btn" onclick="emptyPatientSignatureFields();" class="Recreate btn">Cancel</a>
                                                }
                                            </div>
                                        </div>

                                    </form>

                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<aside id="right-sidebar-nav">
    <div id="slide-out-right14" class="slide-out-right-sidenav sidenav rightside-navigation">
        <div class="row">
            <div class="slide-out-right-title">
                <div class="col s12 border-bottom-1 pb-0 pt-1">
                    <div class="row">
                        <div class="col s2 pl-0 center">
                            <i class="material-icons vertical-text-middle"><a href="#" class="sidenav-close">clear</a></i>
                        </div>
                        <div class="col s10 pl-0 mt-2">

                        </div>
                    </div>
                    <div class="row">


                        <form asp-action="PatientSignatureIdType" asp-controller="PatientSide" method="post" data-ajax="true" data-ajax-success="onCreateIdTpye(data)" class="col s12">
                            <h5 class="mb-10 blue-text">
                                Add ID Type
                                <span class="required"> * </span>
                            </h5>
                            <div class="input-field col s12 mb-10">

                                <input class="text-input sign_IdType SignIdType" type="text" asp-for="PatientSignatureIdTypeBasicDto.TypeName" placeholder="Enter Id Type " />
                                <span class="required" asp-validation-for="PatientSignatureIdTypeBasicDto.TypeName"></span>
                            </div>
                            <button type="submit" class="modal-action btn add-btn right">Save</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

</aside>